---
pipeline:
    name: svPore
    description: "Structural variant analysis from Oxford Nanopore long reads"
    version: v0.0.0
suiteVersions:
    genomex-mdi-tools: main 
actions:
    _global:  
        environment: svPore  
        condaFamilies:
            - genomex-mdi-tools//base
            - genomex-mdi-tools//genome
            - r-4.2
            - adapterTrimming
        optionFamilies:
            - genomex-mdi-tools//genome
    download:
        order: 1
        module: genomex-mdi-tools//nanopore/download             
    convert:
        order: 2
        module: genomex-mdi-tools//nanopore/convert
    basecall:
        order: 3
        module: genomex-mdi-tools//nanopore/basecall
    align:
        order: 4
        module: genomex-mdi-tools//align/dna-long-read
    extract:
        order: 5
        optionFamilies:
            - genomex-mdi-tools//fastq-dir
            - genomex-mdi-tools//read-filtering
            - sv-finding
        resources:
            required:
                total-ram: 16G
            recommended: 
                n-cpu: 8
                ram-per-cpu: 4G
        job-manager:
            recommended:
                time-limit: 4:00:00
        description: "pull molecules that support an SV junction and create a coverage map"
condaFamilies:
    adapterTrimming:
        dependencies:
            - r-e1071
optionFamilies:
    sv-finding:
        options:
            window-power:
                order: 1
                short: P
                type: integer
                required: false
                default: 2
                description: "scan for SVs at a window size resolution of 10^--window-power bp"   
            sv-size-power:
                order: 2
                short: Z
                type: integer
                required: false
                default: 3
                description: "only report SVs >= 10^--sv-size-power bp; smaller indels hide within A segments" 
# package:
#     collate: # the pipeline action after which a data package should assembled
#         uploadType: svAmplicon # a signal to the Stage 2 framework regarding the package contents
#         files:
#             manifestFile:
#                 type: comma-delimited
#                 manifestType: simple
#                 file: $COLLATE_PREFIX.manifest.csv
# container:
#     supported: false    # set to true if you maintain a container registry for this pipeline [false]
#     registry:  ghcr.io  # domain name of your OCI-compatible, oras-accessible, container registry [ghcr.io]
#     owner:     wilsontelab # REQUIRED: the name of the owner, e.g., user or organization, at 'registry'
#     installer: apt-get  # the installer program used by the container OS, typically apt-get or yum [apt-get]
